EQ
EQ is an application for running Electronic Questionnaires, especially designed for use with portable computers.

Easy step-by-step guide to using EQ on the ViewSonic Tablet computer
1. If the machine is currently off,  hold the ViewSonic so that the 3 black buttons are on your right hand side, then press the top button to turn the machine on.
2. You should see a blue screen and 2 icons: tap on the 'EQuser' icon to log in. Enter the password (which you should have been given) using the on-screen keyboard.
4. You should now see a blue screen (the desktop) with several icons. Double-tap the EQ icon, which will start the Electronic Questionnaire and display the "Survey Home" window.
5. If you are intending to use the GPS receiver, plug it into the top-most USB socket on the left side of the ViewSonic.
6. Touch the 'Settings' tab of the Survey Home window. Check that the GPS port, GPS baud rate and Current data directory are set. If not, these should normally be:
GPS port: COM3
Baud Rate: 4800
Current Data Directory: C:\Users\EQuser\Documents\EQdata
If you make/change any settings, press 'Save Settings', so that the program will remember these when it is not running.
Next, touch the 'Test GPS Connection' button, which should say 'Connection Successful'. If you get a warning box instead, then either the settings are wrong (usually the COM port) or GPS receiver was not plugged in. 
Note: If you are using the ND-100S GPS dongle, using  the USB extension cable is recommended to improve the signal strength.
7. Touch the New Questionnaire tab and type the Participant ID (or use the barcode reader, plugged in to the other USB socket).
8. Select a language.
9. Touch 'Start'.
10. This will open a new Window: the "Questionnaire Window". This window is where you will answer all the questions for each participant. The answers to questions are saved to disk automatically as you progress through the form.
11. For each question, read the instructions and enter the requested information by tapping an option and/or using the barcode scanner or the on-screen keyboard. 
12. Press the '> Next Question' button to advance to the next question or the '< Last Question' button to return to the previous question, if you need to make a correction.
13. You can stop at any time by tapping the close button (orange X in top right of window). 
14. To return to the same Questionnaire at a later time, tap the "Existing Questionnaire" tab in the Survey Home window, select the participant ID from the box on the left then tap the "edit Selected Questionnaire button". This will open the Questionnaire at the last question that was answered.
Note: If you can't see the on-screen keyboard, tap on the left centre edge of the screen and an icon should appear which you can drag into the middle of the screen. EQ is designed so that you can place the keyboard in the lower middle section of the display (on top of the logos) and should not generally need to move it.
15. The questionnaire is made up of a number of different sections. You can jump to the start of a section using the "Select Section" drop-down box near the top right corner of the Questionnaire display. It is strongly recommended that sections are answered in their normal order, as some questions depend on the answers to earlier questions.

Detailed Information
There are 4 files that are needed: EQ.exe (the application), EQuestionnaire_English.xml (the English language configuration file), EQuestionnaire_Chewa.xml (the Chewa language configuration file) and EQ_help.txt (the in-program version of this help document).

Set-Up Suggestions
Create a single admin user with a non-trivial password. Create a single non-admin user (e.g. EQuser) with a different non-trivial password (which EQuser cannot change) which is the login that will be used by everybody that runs EQ on the device. Create a directory in 'Documents' which will store all the data generated by EQ. Once the data-directory is created, encrypt it (while logged in as user EQuser) before any files are added to it. Copy EQ.exe to the desktop and the other files to the data directory. When using EQ for the first time, go to the settings tab and set the location of the data directory and the GPS settings. These should not need to be set again unless the values need to be changed for some reason.
If you have a GPS device connected and have set the Port and Baud Rate, you can test the connection by clicking the 'Test GPS Connection' button. If this does not succeed, you have probably set the wrong port number or have not installed the driver correctly for the GPS device. If you are running another program (e.g. a mapping program) which is also connected to the GPS device, you must close that program before running EQ, as only 1 program can connect to the GPS device at a time. Note that you still need to set a port and Baud rate even without a GPS device connected, but you can simply choose any values from the lists. When setting/changing anything in Settings, click the Save button, so the values will be remembered after the program exits.

Usage Guide
Once the program starts, the "Survey Home" window is displayed. From here, you can either create a new questionnaire (New Questionnaire tab) or view/edit an existing Questionnaire (Existing Questionnaire tab). An existing questionnaire may be a fully or partially-completed questionnaire.
To create a new Questionnaire, enter the Participant ID (e.g. by typing or using a barcode reader), select a language and click the 'Start' button. This will open a new "Questionnaire" window with the first question displayed. Each Question is displayed in the top part of the screen. The display is designed so that if you are using a tablet PC, you can position the virtual keyboard in the bottom, centre part of the screen, on top of the logos.
There are 3 buttons on the Questionnaire display:
Next Question button: Processes the response to the current question then moves the display to show the next question. If you have made an error, an error message will be displayed and the current question will be shown again. This will repeat until there are no errors or until the 'Skip' button is pressed.
Last Question button: Shows the previous question (unless you are at the start already). 
GPS Connect button: Used to connect to your GPS device. You should only use this if 'Longitude' or 'Latitude'  show 'GPS disconnected'. If you tested your GPS connection in the settings tab of the home screen and it was OK, it should automatically connect on the Questionnaire screen.
There is also a drop-down list in the top, right-hand corner called 'Select Section'. This is a way to jump to the start of any section in the questionnaire. This is useful if you want to complete a specific section.
Data is saved automatically as you progress through the questionnaire. There are no 'save' buttons on the questionnaire window. To exit a Questionnaire, simply complete the current question then click the window's close box. If you resume editing of the questionnaire, it will automatically start at the last question that you answered. 
Some screens are simple messages, such as introductions to a section and don't require any response. Just read the message then press 'Next Question' to go to the next question.
You can only view/edit ONE questionnaire at a time. If you want to edit a different questionnaire, you must close the current questionnaire window, then select another participant-ID from the 'Existing Questionnaire' tab of the Home window.
You can only have 1 questionnaire per participant. If something goes badly wrong with a questionnaire, exit the window, delete the participant and create a new Questionnaire for that participant-ID. 
The EQ system creates a subdirectory for each participant in the data directory and generates various files within this subdirectory. You MUST NOT edit or move any of these files or the system may not work. If you do accidentally move or damage any files, delete the subdirectory for the participant and create a new questionnaire.
When moving through the questionnaire you must answer each question in turn. It is important to answer each question within a particular section in order. In most cases, if you do not enter a value or select an option, you will see an error message and be asked the answer the question again. This will be repeated until you enter a valid response. 

Other functions in the Existing Questionnaire tab on the Survey Home window.
In the "Existing Questionnaire" tab, there are the following buttons:
Edit Selected Questionnaire button: Opens the selected questionnaire in the Questionnaire window at the question that was last answered. If the questionnaire is locked, you cannot edit it, i.e. you must first unlock it.
Note that if you create a new questionnaire but exit from it without answering any questions, you will get an error if you try and open it again. In this case you must delete it.
Delete Selected Questionnaire button: Deletes all data for the selected Questionnaire. Once deleted, all data is lost unless you first copied the data with the 'Copy All Data' button. If the questionnaire is locked, you cannot delete it, i.e. you must unlock it first.
Lock Selected Questionnaire button: Stops the selected questionnaire from being edited or deleted. The name will appear with "(locked)" appended to it in the menu.
Unlock Selected Questionnaire button: Unlocks the selected questionnaire if it was previously locked. 
Copy All Data button: Copies the data files for all participants (1 file per questionnaire) to a directory that you select. This should be used to transfer the data to a memory stick prior to database loading.

Data Encryption
If you want to have the data in an encrypted form so that unauthorized users cannot access it, you should encrypt the data directory. The directory must be on an NTFS file system, which is generally true for Windows XP/7 hard-discs (C-drive). Right-click (or long-touch for a touch-screen) the folder icon, then select 'Properties' from the menu. In the General tab, click advanced, then check "Encrypt contents to secure data". Click OK and OK again.
Any data subsequently written to the encrypted folder will be hidden from any user who is not the user that created it. This includes the admin user. This type of data protection uses the password of the logged-in user as the key. If the password is changed by an admin user, then the data will be UNRECOVERABLE, so it is VERY IMPORTANT that this does not happen. Note that it is possible for an administrator to stop a user from being able to change their own password, although this is not enabled by default.

Data Formats
Data is stored in a simple text format, where each question/answer has a single line. The question code is first, then the response (separated by a tab character). For example, Question 19 has the code TOB1 and has 2 possible answers yes (1) and no (2). If the answer to the question was yes, it would be shown as:
TOB1	1
The codes for most questions are as shown in the pdf version of the survey, however a couple of codes have been changed as they were duplicated in the pdf version. There are also a few extra codes that result from the needs of the program, although some of  these can be ignored.
In the consents section there are some duplicated codes, e.g. CON1, CON1B.
CON1 records the first response to the question. If the participant answers no, then the question is repeated and CON1B records the second response if needed.
There is a special code "ENTRY_REFUSED", which indicates that the question has been skipped.
I've coded Q77 as 'BPG', rather than 'BCG', which was used for Q70a.
I've coded Q86 (HCAVG) as HIPCAVG due to a conflict.
I've added the code 'BLOODMASTER', for Q88 to represent the lab master code.
I've added the code 'PARTICIPANTFINALSTATUS' for the participant status.
I've added the code 'INTERVIEWERCOMMENTS' for any final comments from the interviewer.
I've added the code 'SPINE' for the participant's SPINE number.
Codes for data-manager review used by a number of the questions in the physical measurements section are as follows:
systolic blood pressure: DATA_MANAGER_REVIEW_SYST
diastolic blood pressure: DATA_MANAGER_REVIEW_DIAST
pulse: DATA_MANAGER_REVIEW_PLS
height: DATA_MANAGER_REVIEW_HEIGHT
weight: DATA_MANAGER_REVIEW_WEIGHT
hips circumference: DATA_MANAGER_REVIEW_HIPC
waist circumference: DATA_MANAGER_REVIEW_WC
Dates are formatted: day/month/year
Times are formatted: hours:mins
GPS location is formatted as decimal degrees where the number is positive for latitudes North of the equator and longitudes East of the prime meridian (Greenwich, U.K.) and negative for latitudes South of the equator and longitudes West of the prime meridian.
e.g. 
latitude:52.078173333333, longitude:0.185345


















